<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tetonor Cl√°sico</title>
    <style>
        :root { --primary: #0056b3; --bg: #f4f4f9; --cell-size: 80px; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: var(--bg); display: flex; flex-direction: column; align-items: center; padding: 20px; margin: 0; color: #333; }
        
        .game-card { background: white; padding: 25px; border-radius: 12px; box-shadow: 0 5px 20px rgba(0,0,0,0.15); max-width: 600px; width: 100%; text-align: center; }
        h1 { margin-top: 0; color: #444; letter-spacing: 1px; }
        
        /* Grid del juego */
        .grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin: 20px 0; }
        .cell { border: 2px solid #333; height: 90px; display: flex; flex-direction: column; align-items: center; justify-content: space-between; position: relative; background: #fff; border-radius: 4px; padding-bottom: 5px; }
        .res-num { font-size: 1.5rem; font-weight: 800; margin-top: 5px; color: #000; }
        
        .input-box { width: 100%; display: flex; justify-content: space-evenly; border-top: 1px solid #aaa; padding-top: 5px; }
        input { width: 35px; border: none; text-align: center; font-size: 1.1rem; font-weight: bold; color: var(--primary); outline: none; background: transparent; border-bottom: 2px solid transparent; }
        input:focus { border-bottom: 2px solid var(--primary); }
        
        .op-sign { position: absolute; bottom: 35px; font-size: 0.9rem; font-weight: bold; color: #007bff; background: white; padding: 0 4px; }

        /* Lista de n√∫meros abajo */
        .list-container { margin-top: 15px; border: 2px solid #555; padding: 5px; background: #eee; }
        .list-title { font-size: 0.8rem; font-weight: bold; text-transform: uppercase; margin-bottom: 5px; }
        .number-list { display: flex; flex-wrap: wrap; justify-content: center; gap: 5px; }
        .num-item { width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; border: 1px solid #999; background: white; font-weight: bold; font-size: 0.9rem; cursor: pointer; }
        .num-used { background-color: #aaa; color: #555; text-decoration: line-through; }

        /* Controles */
        .controls { margin-top: 25px; display: flex; gap: 10px; flex-wrap: wrap; justify-content: center; }
        .btn { padding: 10px 18px; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; color: white; transition: 0.2s; font-size: 0.9rem; }
        .btn-check { background: #28a745; }
        .btn-hint { background: #ffc107; color: #333; }
        .btn-new { background: #6c757d; }
        .btn-info { background: #17a2b8; }
        .btn:hover { transform: translateY(-2px); opacity: 0.9; }

        #msg { margin-top: 15px; font-weight: bold; height: 24px; }
        .correct-cell { border-color: #28a745; background-color: #e8f5e9; }
        .wrong-cell { border-color: #dc3545; background-color: #f8d7da; }

        /* Secci√≥n de Ayuda (Oculta) */
        #info-section { display: none; background: #fff3cd; border: 1px solid #ffeeba; color: #856404; padding: 15px; margin-top: 20px; border-radius: 8px; text-align: left; font-size: 0.9rem; }
        #info-section h3 { margin-top: 0; }
        #info-section ul { padding-left: 20px; }
    </style>
</head>
<body>

<div class="game-card">
    <h1>TETONOR</h1>
    
    <div id="game-grid" class="grid"></div>
    
    <div class="list-container">
        <div class="list-title">N√∫meros Disponibles (Pista)</div>
        <div id="num-list" class="number-list"></div>
    </div>

    <div id="msg"></div>

    <div class="controls">
        <button class="btn btn-check" onclick="checkAll()">Comprobar</button>
        <button class="btn btn-hint" onclick="giveHint()">üí° Pista</button>
        <button class="btn btn-new" onclick="generateGame()">Nuevo Juego</button>
        <button class="btn btn-info" onclick="toggleInfo()">‚ùì Ayuda</button>
    </div>

    <div id="info-section">
        <h3>C√≥mo jugar:</h3>
        <ul>
            <li>El objetivo es completar las casillas inferiores de cada cuadro.</li>
            <li>El n√∫mero grande arriba es el <strong>Resultado</strong>.</li>
            <li>El signo azul (<strong>+</strong> o <strong>√ó</strong>) indica la operaci√≥n.</li>
            <li>Debes encontrar qu√© par de n√∫meros, al sumarse o multiplicarse, dan ese resultado.</li>
            <li><strong>Importante:</strong> Los n√∫meros que uses deben salir de la "Lista de N√∫meros Disponibles" que ves abajo.</li>
            <li>¬°Cada n√∫mero de la lista se usa solo una vez!</li>
        </ul>
    </div>
</div>

<script>
    let solution = [];
    let availableNumbers = [];

    function generateGame() {
        const grid = document.getElementById('game-grid');
        const listDiv = document.getElementById('num-list');
        const msg = document.getElementById('msg');
        grid.innerHTML = '';
        listDiv.innerHTML = '';
        msg.textContent = '';
        
        // Limpiar estilos anteriores
        document.getElementById('info-section').style.display = 'none';

        // 1. Generar pares de n√∫meros para 8 celdas (16 n√∫meros en total)
        availableNumbers = [];
        solution = [];
        
        // Generamos 8 pares l√≥gicos
        for(let i=0; i<8; i++) {
            // N√∫meros base entre 2 y 12 para que las multiplicaciones no sean gigantes
            let n1 = Math.floor(Math.random() * 10) + 2; 
            let n2 = Math.floor(Math.random() * 10) + 2;
            
            // Decidir operaci√≥n (50% prob)
            let isMult = Math.random() > 0.5;
            let result = isMult ? n1 * n2 : n1 + n2;

            // Guardar soluci√≥n
            solution.push({ n1, n2, result, isMult });
            
            // Guardar n√∫meros para la lista visual
            availableNumbers.push(n1, n2);
        }

        // Ordenar lista de n√∫meros para mostrar abajo
        availableNumbers.sort((a, b) => a - b);

        // 2. Dibujar la cuadr√≠cula
        solution.forEach((sol, i) => {
            const cell = document.createElement('div');
            cell.className = 'cell';
            cell.innerHTML = `
                <div class="res-num">${sol.result}</div>
                <div class="op-sign">${sol.isMult ? '√ó' : '+'}</div>
                <div class="input-box">
                    <input type="number" class="user-in" data-idx="${i}" data-pos="1" placeholder="?">
                    <input type="number" class="user-in" data-idx="${i}" data-pos="2" placeholder="?">
                </div>
            `;
            grid.appendChild(cell);
        });

        // 3. Dibujar la lista de n√∫meros abajo
        availableNumbers.forEach(num => {
            const span = document.createElement('div');
            span.className = 'num-item';
            span.textContent = num;
            listDiv.appendChild(span);
        });
    }

    function checkAll() {
        const inputs = document.querySelectorAll('.user-in');
        let allCorrect = true;

        solution.forEach((sol, i) => {
            const input1 = document.querySelector(`input[data-idx="${i}"][data-pos="1"]`);
            const input2 = document.querySelector(`input[data-idx="${i}"][data-pos="2"]`);
            const val1 = parseInt(input1.value);
            const val2 = parseInt(input2.value);
            const parent = input1.closest('.cell');

            let isPairCorrect = false;

            if (val1 && val2) {
                // Verificar si la operaci√≥n matem√°tica es correcta
                let mathCorrect = false;
                if (sol.isMult) {
                    if (val1 * val2 === sol.result) mathCorrect = true;
                } else {
                    if (val1 + val2 === sol.result) mathCorrect = true;
                }

                // Verificar si los n√∫meros usados estaban en la lista (simplificado para jugabilidad: 
                // solo validamos que la matem√°tica sea correcta para este par)
                if (mathCorrect) isPairCorrect = true;
            }

            if(isPairCorrect) {
                parent.classList.add('correct-cell');
                parent.classList.remove('wrong-cell');
            } else {
                allCorrect = false;
                if (val1 || val2) { // Solo marcar error si intentaron escribir algo
                    parent.classList.add('wrong-cell');
                    parent.classList.remove('correct-cell');
                }
            }
        });

        const msg = document.getElementById('msg');
        if(allCorrect) {
            msg.textContent = "¬°FELICIDADES! Has resuelto el tablero.";
            msg.style.color = "green";
        } else {
            msg.textContent = "Hay errores, revisa las casillas rojas.";
            msg.style.color = "#dc3545";
        }
        
        updateNumberListStrike();
    }

    // Tachar n√∫meros usados en la lista
    function updateNumberListStrike() {
        // Obtenemos todos los valores escritos por el usuario
        const inputs = document.querySelectorAll('.user-in');
        let usedValues = [];
        inputs.forEach(inp => {
            if(inp.value) usedValues.push(parseInt(inp.value));
        });

        // Reiniciamos visualmente la lista
        const listItems = document.querySelectorAll('.num-item');
        listItems.forEach(item => item.classList.remove('num-used'));

        // Tachamos los que coincidan (l√≥gica visual simple)
        listItems.forEach(item => {
            const val = parseInt(item.textContent);
            const foundIndex = usedValues.indexOf(val);
            if(foundIndex !== -1) {
                item.classList.add('num-used');
                usedValues.splice(foundIndex, 1); // Remover para no tachar repetidos incorrectamente
            }
        });
    }

    function giveHint() {
        const inputs = Array.from(document.querySelectorAll('.user-in')).filter(i => !i.value);
        if(inputs.length > 0) {
            // Elegir una casilla vac√≠a al azar
            const target = inputs[Math.floor(Math.random() * inputs.length)];
            const idx = target.getAttribute('data-idx');
            const pos = target.getAttribute('data-pos');
            
            // Rellenar con la soluci√≥n correcta
            target.value = pos == "1" ? solution[idx].n1 : solution[idx].n2;
            
            // Feedback visual
            target.style.backgroundColor = "#fff3cd";
            updateNumberListStrike();
        } else {
            document.getElementById('msg').textContent = "¬°Ya no hay casillas vac√≠as!";
        }
    }

    function toggleInfo() {
        const info = document.getElementById('info-section');
        if (info.style.display === 'block') {
            info.style.display = 'none';
        } else {
            info.style.display = 'block';
        }
    }

    // Detectar cambios en inputs para actualizar tachado de lista
    document.addEventListener('input', (e) => {
        if(e.target.classList.contains('user-in')) {
            updateNumberListStrike();
        }
    });

    window.onload = generateGame;
</script>

</body>
</html>
